{% extends "base.html" %}

{% block content %}
{% if selected_datagroup %}
<h2>Update Data Group: {{ selected_datagroup.name }}</h2>
<form method="post" action="{{ url_for('update_datagroup') }}">
    <input type="hidden" name="name" value="{{ selected_datagroup.name }}">
    <label for="type">Data Group Type:</label>
    <select id="type" name="type" required>
        <option value="string" {% if selected_datagroup.type == 'string' %}selected{% endif %}>String</option>
        <option value="integer" {% if selected_datagroup.type == 'integer' %}selected{% endif %}>Integer</option>
        <option value="address" {% if selected_datagroup.type == 'address' %}selected{% endif %}>Address</option>
    </select>
    <br><br>
    <label for="records">Records:</label>
    <div id="records">
        {% for record in selected_datagroup.records %}
        <div class="record">
            <input type="text" name="records_name" placeholder="Name" value="{{ record.name }}" required>
            <input type="text" name="records_data" placeholder="Data" value="{{ record.data }}" required>
            <button type="button" onclick="removeRecord(this)">Delete</button>
        </div>
        {% endfor %}
    </div>
    <button type="button" onclick="addRecord()">Add Record</button>
    <br><br>
    <button type="submit">Update Data Group</button>
</form>
{% else %}
<p>Data group not found.</p>
{% endif %}

<script>
function addRecord() {
    const recordDiv = document.createElement('div');
    recordDiv.className = 'record';
    recordDiv.innerHTML = `
        <input type="text" name="records_name" placeholder="Name" required>
        <input type="text" name="records_data" placeholder="Data" required>
        <button type="button" onclick="removeRecord(this)">Delete</button>
    `;
    document.getElementById('records').appendChild(recordDiv);
}

function removeRecord(button) {
    button.parentElement.remove();
}
</script>
{% endblock %}
