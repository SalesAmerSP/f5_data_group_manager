{% extends "base.html" %}

{% block content %}
<h2>Update Data Group</h2>
<form method="post" action="{{ url_for('update_datagroup') }}">
    <label for="name">Data Group Name:</label>
    <select id="name" name="name" required onchange="this.form.submit()">
        <option value="" disabled selected>Select a Data Group</option>
        {% for datagroup in datagroups %}
        <option value="{{ datagroup.name }}" {% if selected_datagroup and datagroup.name == selected_datagroup.name %}selected{% endif %}>{{ datagroup.name }}</option>
        {% endfor %}
    </select>
    <br><br>
    {% if selected_datagroup %}
    <label for="records">Records:</label>
    <div id="records">
        {% for record in selected_datagroup.records %}
        <div class="record">
            <input type="text" name="records_name" value="{{ record.name }}" required>
            <input type="text" name="records_data" value="{{ record.data }}" required>
            <button type="button" onclick="removeRecord(this)">Delete</button>
        </div>
        {% endfor %}
    </div>
    <button type="button" onclick="addRecord()">Add Record</button>
    <br><br>
    <button type="submit">Update Data Group</button>
    {% endif %}
</form>

<script>
function addRecord() {
    const recordDiv = document.createElement('div');
    recordDiv.className = 'record';
    recordDiv.innerHTML = `
        <input type="text" name="records_name" placeholder="Name" required>
        <input type="text" name="records_data" placeholder="Data" required>
        <button type="button" onclick="removeRecord(this)">Delete</button>
    `;
    document.getElementById('records').appendChild(recordDiv);
}

function removeRecord(button) {
    button.parentElement.remove();
}
</script>
{% endblock %}
